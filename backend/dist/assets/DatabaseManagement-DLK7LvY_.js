import{r as l,j as e,b as d}from"./index-Vu9aRgsR.js";function E(){const[v,m]=l.useState([]),[D,u]=l.useState([]),[r,p]=l.useState(""),[n,b]=l.useState(""),[c,f]=l.useState(""),[i,g]=l.useState(""),[h,w]=l.useState(""),[x,j]=l.useState("");l.useEffect(()=>{(async()=>{try{const s=await d.get("/api/backup/getData",{withCredentials:!0});m(s.data);const t=s.data.map(o=>o.fileName);u(t),t.length&&(p(t[t.length-1]),b(t[t.length-2]),f(t[t.length-3]))}catch(s){console.error("Error fetching backups:",s)}})()},[]),l.useEffect(()=>{const a=s=>{if(typeof s=="string"){const t=s.split("_"),o=t[1],k=t[2];return{month:o,year:k}}else return s};if(r){const{month:s,year:t}=a(r);g({month:s,year:t})}if(n){const{month:s,year:t}=a(n);w({month:s,year:t})}if(c){const{month:s,year:t}=a(c);j({month:s,year:t})}},[r,n,c]);const y=async()=>{try{const a=await d.get("/api/backup/export-data",{responseType:"blob",withCredentials:!0}),s=a.headers["x-filename"];if(!s)throw new Error("Filename not found in headers");const t=window.URL.createObjectURL(new Blob([a.data])),o=document.createElement("a");o.href=t,o.setAttribute("download",s),document.body.appendChild(o),o.click()}catch(a){console.error("Error exporting data:",a)}},N=async()=>{try{await d.delete("/api/backup/deleteData",{withCredentials:!0}),alert("All data deleted successfully")}catch(a){console.error("Error deleting data:",a),alert("Failed to delete data")}};return e.jsxs("div",{className:"min-h-screen flex flex-col items-center  p-4",children:[e.jsx("h1",{className:"text-xl font-bold  text-gray-700 font-serif uppercase mb-8",children:"Database Management"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-5xl",children:[e.jsxs("div",{className:"bg-red-500 text-white rounded-lg shadow-md p-6 flex flex-col items-center justify-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Delete All Data"}),e.jsx("button",{className:"bg-white text-red-500 px-4 py-2 rounded hover:bg-red-200",onClick:N,children:"Delete"})]}),e.jsxs("div",{className:"bg-blue-500 text-white rounded-lg shadow-md p-6 flex flex-col items-center justify-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Download All Data"}),e.jsx("button",{className:"bg-white text-blue-500 px-4 py-2 rounded hover:bg-blue-200",onClick:y,children:"Download"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 w-full max-w-5xl mt-8",children:[e.jsxs("div",{className:"bg-green-500 text-white rounded-lg shadow-md p-6 flex flex-col items-center justify-center",children:[r?e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:[i.month," ",i.year," Backup"]}):e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Backup file Not Available"}),e.jsx("button",{className:"bg-white text-green-500 px-4 py-2 rounded hover:bg-green-200",children:e.jsx("a",{href:`/api/backup/download/${r}`,download:!0,children:"Download"})})]}),e.jsxs("div",{className:"bg-yellow-500 text-white rounded-lg shadow-md p-6 flex flex-col items-center justify-center",children:[n?e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:[h.month," ",h.year," Backup"]}):e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Backup file Not Available"}),e.jsx("button",{className:"bg-white text-yellow-500 px-4 py-2 rounded hover:bg-yellow-200",children:e.jsx("a",{href:`/api/backup/download/${n}`,download:!0,children:"Download"})})]}),e.jsxs("div",{className:"bg-purple-500 text-white rounded-lg shadow-md p-6 flex flex-col items-center justify-center",children:[c?e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:[x.month," ",x.year," Backup"]}):e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Backup file Not Available"}),e.jsx("button",{className:"bg-white text-purple-500 px-4 py-2 rounded hover:bg-purple-200",children:e.jsx("a",{href:`/api/backup/download/${c}`,download:!0,children:"Download"})})]})]})]})}export{E as default};
