import{r as a,E as $e,s as Ie,b as c,j as e}from"./index-DYrfXb_W.js";import{R as Ae}from"./quill.snow-Bpog9s7S.js";const qe=()=>{var te,se,ae,le,oe,ne,re,ce;const[h,C]=a.useState(""),[S,k]=a.useState(""),[b,F]=a.useState([]),[o,p]=a.useState(""),[P,$]=a.useState(""),[I,A]=a.useState(""),[M,_]=a.useState(""),[q,D]=a.useState(""),[R,E]=a.useState(""),[B,T]=a.useState(""),[O,L]=a.useState(""),[de,j]=a.useState(),[U,z]=a.useState(),[X,H]=a.useState(),[K,Q]=a.useState(""),[V,W]=a.useState(""),[Y,G]=a.useState("active"),[d,ue]=a.useState([]),[r,J]=a.useState(""),[u,v]=a.useState(""),[y,g]=a.useState(""),{slugs:N}=$e(),[Z,ee]=a.useState([]),[w,me]=a.useState([]),[m,x]=a.useState([]),he=Ie(),be={toolbar:[[{font:[]}],["bold","italic","underline","strike","blockquote"],[{header:[1,2,3,4,5,6,!1]}],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],["link","image","video"],[{direction:"rtl"}],[{color:[]},{background:[]}],[{align:[]}],["clean"]],clipboard:{matchVisual:!1}},pe=async()=>{try{const s=await c.get("/api/news/getAll",{withCredentials:!0});ue(s.data)}catch(s){console.error(s)}};a.useEffect(()=>{ge(),pe()},[]);const ge=async()=>{try{const t=(await c.get(`/api/news/getNewsById?slugs=${N}`,{withCredentials:!0})).data.data;C(t.title),k(t.details),ee(t.photo),W(t.date),G(t.status),x(t.alt),Q(t.postedBy),p(t.slug),$(t.metatitle),A(t.metadescription),_(t.metakeywords),D(t.metalanguage),E(t.metacanonical),T(t.metaschema),L(t.otherMeta),t.url?j(t.url):j(`http://localhost:3000/news/${t.slug}`),z(t.changeFreq),H(t.priority);const n=(await c.get(`/api/news/getSpecificCategory?categoryId=${t.categories}`,{withCredentials:!0})).data;J(n._id);const f=(await c.get(`/api/news/getSpecificSubcategory?categoryId=${t.categories}&subCategoryId=${t.subcategories}`,{withCredentials:!0})).data;v(f._id);const Pe=(await c.get(`/api/news/getSpecificSubSubcategory?categoryId=${t.categories}&subCategoryId=${t.subcategories}&subSubCategoryId=${t.subSubcategories}`,{withCredentials:!0})).data;g(Pe._id)}catch(s){console.error(s)}},xe=async s=>{s.preventDefault();try{const t=new FormData;t.append("title",h),t.append("details",S),t.append("date",V),t.append("slug",o),t.append("metatitle",P),t.append("metakeywords",M),t.append("metadescription",I),t.append("metalanguage",q),t.append("metacanonical",R),t.append("metaschema",B),t.append("otherMeta",O),t.append("url",de),t.append("changeFreq",U),t.append("priority",X),t.append("postedBy",K),t.append("status",Y),t.append("categories",r),t.append("subcategories",u),t.append("subSubcategories",y);const l=[...m,...w];b.forEach(i=>{t.append("photo",i)}),l.forEach(i=>{t.append("alt",i)});const n=await c.put(`/api/news/updateNews?slugs=${N}`,t,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0});he("/news")}catch(t){console.error(t)}},fe=s=>{const t=Array.from(s.target.files);F([...b,...t])},je=(s,t)=>{const l=[...m];l[t]=s.target.value,x(l)},ve=(s,t)=>{const l=[...w];l[t]=s.target.value,me(l)};a.useEffect(()=>{o&&j(`http://localhost:3000/news/${o}`)},[o]),a.useEffect(()=>{p(h)},[h]),a.useEffect(()=>{p(o.replace(/\s+/g,"-").toLowerCase())},[o]);const ye=(s,t,l)=>{s.preventDefault(),c.delete(`/api/news/${N}/image/${t}/${l}`,{withCredentials:!0}).then(n=>{const i=Z.filter(ie=>ie!==t);ee(i);const f=[...m];f.splice(l,1),x(f)}).catch(n=>{console.error(n)})},Ne=(s,t)=>{s.preventDefault();const l=[...b];l.splice(t,1),F(l);const n=[...m];n.splice(t,1),x(n)},we=s=>e.jsx("option",{value:s._id,selected:r,children:s.category},s._id),Ce=s=>e.jsx("option",{value:s._id,selected:u,children:s.category},s._id),Se=s=>e.jsx("option",{value:s._id,selected:y,children:s.category},s._id),ke=s=>{const t=s.target.value;J(t),v(""),g("")},Fe=s=>{const t=s.target.value;v(t),g("")};return e.jsxs("form",{onSubmit:xe,className:"p-4",children:[e.jsx("h1",{className:"text-xl font-bold font-serif text-gray-700 uppercase text-center",children:"Edit News"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"parentCategory",className:"block font-semibold mb-2",children:"Parent Category"}),e.jsxs("select",{id:"parentCategory",value:r,onChange:ke,className:"w-full p-2 border rounded focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Parent Category"}),d.map(we)]})]}),((te=d.find(s=>s._id===r))==null?void 0:te.subCategories.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"subCategory",className:"block font-semibold mb-2",children:"Subcategory"}),e.jsxs("select",{id:"subCategory",value:u,onChange:Fe,className:"w-full p-2 border rounded focus:outline-none",children:[e.jsx("option",{value:"",children:"Select Subcategory"}),(ae=(se=d.find(s=>s._id===r))==null?void 0:se.subCategories)==null?void 0:ae.map(Ce)]})]}),((oe=(le=d.find(s=>s._id===r))==null?void 0:le.subCategories.find(s=>s._id===u))==null?void 0:oe.subSubCategories.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"subSubCategory",className:"block font-semibold mb-2",children:"Sub-Subcategory"}),e.jsxs("select",{id:"subSubCategory",value:y,onChange:s=>g(s.target.value),className:"w-full p-2 border rounded focus:outline-none",children:[e.jsx("option",{value:"",children:"Select Sub-Subcategory"}),(ce=(re=(ne=d.find(s=>s._id===r))==null?void 0:ne.subCategories.find(s=>s._id===u))==null?void 0:re.subSubCategory)==null?void 0:ce.map(Se)]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"title",className:"block font-semibold mb-2",children:"Title"}),e.jsx("input",{type:"text",id:"title",value:h,onChange:s=>C(s.target.value),className:"w-full p-2 border rounded focus:outline-none",required:!0})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{htmlFor:"details",className:"block font-semibold mb-2",children:"Description"}),e.jsx(Ae,{value:S,onChange:k,modules:be,className:"quill"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold mb-2",children:"Current Photos"}),e.jsx("div",{className:"flex flex-wrap gap-4",children:Z.map((s,t)=>e.jsxs("div",{className:"relative w-56",children:[e.jsx("img",{src:`/api/image/download/${s}`,alt:`Photo ${t+1}`,className:"w-56 h-32 object-cover"}),e.jsxs("label",{htmlFor:`alt-${t}`,className:"block mt-2",children:["Alternative Text:",e.jsx("input",{type:"text",id:`alt-${t}`,value:m[t],onChange:l=>je(l,t),className:"w-full p-2 border rounded focus:outline-none"})]}),e.jsx("button",{onClick:l=>ye(l,s,t),className:"absolute top-4 right-2 bg-red-500 text-white rounded-md p-1 size-6 flex justify-center items-center",children:e.jsx("span",{className:"text-xs",children:"X"})})]},t))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold mb-2",children:"Add New Photos"}),e.jsx("input",{type:"file",onChange:fe,multiple:!0,accept:"image/*",className:"p-2 border rounded"}),e.jsx("div",{className:"flex flex-wrap gap-4 mt-4",children:b.map((s,t)=>e.jsxs("div",{className:"relative w-56",children:[e.jsx("img",{src:URL.createObjectURL(s),alt:`New Photo ${t+1}`,className:"w-56 h-32 object-cover"}),e.jsxs("label",{htmlFor:`alt-new-${t}`,className:"block mt-2",children:["Alternative Text:",e.jsx("input",{type:"text",id:`alt-new-${t}`,value:w[t]||"",onChange:l=>ve(l,t),className:"w-full p-2 border rounded focus:outline-none"})]}),e.jsx("button",{onClick:l=>Ne(l,t),className:`absolute top-4 right-2 bg-red-500 text-white rounded-md p-1 size-6 flex\r
                justify-center items-center`,children:e.jsx("span",{className:"text-xs",children:"X"})})]},t))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"postedBy",className:"block font-semibold mb-2",children:"Posted By"}),e.jsx("input",{type:"text",id:"postedBy",value:K,onChange:s=>Q(s.target.value),className:"w-full p-2 border rounded focus:outline-none",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"date",className:"block font-semibold mb-2",children:"Date"}),e.jsx("input",{type:"date",id:"date",value:V,onChange:s=>W(s.target.value),className:"w-full p-2 border rounded focus:outline-none",required:!0})]}),e.jsxs("div",{className:"mb-4 mt-4",children:[e.jsx("label",{htmlFor:"slug",className:"block font-semibold mb-2",children:"Slug"}),e.jsx("input",{type:"text",id:"slug",value:o,onChange:s=>p(s.target.value),className:"w-full p-2 border rounded focus:outline-none"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"url",className:"block font-semibold mb-2",children:"URL"}),e.jsx("input",{disabled:!0,type:"url",id:"url",value:`http://localhost:3000/news/${o}`,className:"w-full p-2 border rounded focus:outline-none"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Meta Title"}),e.jsx("textarea",{id:"meta",value:P,onChange:s=>$(s.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Meta Description"}),e.jsx("textarea",{id:"meta",value:I,onChange:s=>A(s.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Meta Keywords"}),e.jsx("textarea",{id:"meta",value:M,onChange:s=>_(s.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Meta Canonical"}),e.jsx("textarea",{id:"meta",value:R,onChange:s=>E(s.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Meta Language"}),e.jsx("textarea",{id:"meta",value:q,onChange:s=>D(s.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Other Meta"}),e.jsx("textarea",{id:"meta",value:O,onChange:s=>L(s.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Schema"}),e.jsx("textarea",{id:"meta",value:B,onChange:s=>T(s.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"priority",className:"block font-semibold mb-2",children:"Priority"}),e.jsx("input",{type:"number",id:"priority",min:0,max:1,step:.01,value:X,onChange:s=>H(s.target.value),className:"w-full p-2 border rounded focus:outline-none"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"changeFreq",className:"block font-semibold mb-2",children:"Change Frequency"}),e.jsxs("select",{id:"changeFreq",value:U,onChange:s=>z(s.target.value),className:"w-full p-2 border rounded focus:outline-none",children:[e.jsx("option",{value:"",children:"Select Change Frequency"}),e.jsx("option",{value:"always",children:"Always"}),e.jsx("option",{value:"hourly",children:"Hourly"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"status",className:"block font-semibold mb-2",children:"Status"}),e.jsxs("select",{id:"status",value:Y,onChange:s=>G(s.target.value),className:"w-full p-2 border rounded focus:outline-none",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 focus:outline-none",children:"Save Changes"})})]})};export{qe as default};
